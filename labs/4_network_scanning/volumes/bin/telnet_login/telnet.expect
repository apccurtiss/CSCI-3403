#!/usr/bin/expect

#If it all goes pear shaped the script will timeout after 20 seconds.
set timeout 20

set ip [lindex $argv 0]
set user [lindex $argv 1]
set password [lindex $argv 2]

spawn telnet $ip

expect "login:"
send "$user\r"

sleep 1

expect "Password:"
send "$password\r"

sleep 1

expect "$ "

send "ls\r"
expect "$ "

sleep 1

send "exit\r"

expect "."

exit